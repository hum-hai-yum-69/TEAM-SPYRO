<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Smart Parking - Customer</title>

<style>

*{
margin:0;
padding:0;
box-sizing:border-box;
font-family:'Segoe UI',Arial,sans-serif;
}

body{
height:100vh;
display:flex;
justify-content:center;
align-items:center;
background:
linear-gradient(rgba(0,0,0,0.6),rgba(0,0,0,0.6)),
url("carparking.jpeg") center/cover no-repeat;
}

.box{
width:380px;
padding:35px;
background:rgba(255,255,255,0.12);
backdrop-filter:blur(20px);
border-radius:18px;
box-shadow:0 10px 40px rgba(0,0,0,0.4);
text-align:center;
color:white;
}

h2{
margin-bottom:20px;
}

input{
width:100%;
padding:12px;
margin:8px 0;
border-radius:8px;
border:none;
background:rgba(255,255,255,0.2);
color:white;
outline:none;
}

input::placeholder{
color:#eee;
}

button{
width:100%;
padding:13px;
border:none;
border-radius:10px;
margin-top:12px;
cursor:pointer;
font-weight:bold;
background:linear-gradient(45deg,#2196F3,#00BCD4);
color:white;
transition:0.3s;
}

button:hover{
transform:translateY(-2px);
}

.switch{
margin-top:12px;
font-size:13px;
cursor:pointer;
color:#ffeb3b;
}

.switch:hover{
color:white;
}

.error{
color:#ff5252;
font-size:13px;
margin-top:10px;
}

.success{
color:#69f0ae;
font-size:13px;
margin-top:10px;
}

</style>
</head>

<body>

<div class="box">

<h2 id="title">Customer Login</h2>

<input id="name" placeholder="Full Name" style="display:none">
<input id="phone" placeholder="Phone Number" style="display:none">
<input id="confirm" type="password" placeholder="Confirm Password" style="display:none">

<input id="email" type="email" placeholder="Gmail">
<input id="password" type="password" placeholder="Password">

<button onclick="mainAction()" id="mainBtn">Login</button>

<div class="switch" onclick="toggleForm()" id="switchText">
Don’t have account? Create account
</div>

<div id="status"></div>

</div>


<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { getAuth,
createUserWithEmailAndPassword,
signInWithEmailAndPassword,
onAuthStateChanged }
from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";

import { getDatabase, ref, set }
from "https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js";


const firebaseConfig={
apiKey:"AIzaSyAkbz_WM6KT56g1awB-TviU8Uo1svrivJw",
authDomain:"carparkingapp-9267e.firebaseapp.com",
databaseURL:"https://carparkingapp-9267e-default-rtdb.firebaseio.com/",
projectId:"carparkingapp-9267e"
};

const app=initializeApp(firebaseConfig);
const auth=getAuth(app);
const db=getDatabase(app);

let isLogin=true;


// AUTO LOGIN SESSION
onAuthStateChanged(auth,(user)=>{
if(user){
window.location.href="customer-dashboard.html";
}
});


// SWITCH FORM
window.toggleForm=function(){

isLogin=!isLogin;

document.getElementById("name").style.display=isLogin?"none":"block";
document.getElementById("phone").style.display=isLogin?"none":"block";
document.getElementById("confirm").style.display=isLogin?"none":"block";

document.getElementById("title").innerText=
isLogin?"Customer Login":"Create Customer Account";

document.getElementById("mainBtn").innerText=
isLogin?"Login":"Create Account";

document.getElementById("switchText").innerText=
isLogin?"Don’t have account? Create account":"Already have account? Login";

document.getElementById("status").innerHTML="";
}


// MAIN ACTIO
window.mainAction=function(){

const email=document.getElementById("email").value.trim();
const password=document.getElementById("password").value.trim();
const status=document.getElementById("status");

status.innerHTML="";

if(email==="" || password===""){
status.innerHTML="<div class='error'>All fields required</div>";
return;
}

if(isLogin){

signInWithEmailAndPassword(auth,email,password)
.then(()=>{
status.innerHTML="<div class='success'>Login Successful</div>";
})
.catch(e=>{
status.innerHTML="<div class='error'>"+e.message+"</div>";
});

}else{

const name=document.getElementById("name").value.trim();
const phone=document.getElementById("phone").value.trim();
const confirm=document.getElementById("confirm").value.trim();

if(name==="" || phone==="" || confirm===""){
status.innerHTML="<div class='error'>Please fill all details</div>";
return;
}

if(password.length<6){
status.innerHTML="<div class='error'>Password must be 6+ characters</div>";
return;
}

if(password!==confirm){
status.innerHTML="<div class='error'>Passwords do not match</div>";
return;
}

const customerId="CUST-"+Math.floor(100000+Math.random()*900000);

createUserWithEmailAndPassword(auth,email,password)
.then((cred)=>{

set(ref(db,"customers/"+cred.user.uid),{
customerId:customerId,
name:name,
phone:phone,
email:email,
createdAt:Date.now()
});

status.innerHTML="<div class='success'>Account Created Successfully</div>";

})
.catch(e=>{
status.innerHTML="<div class='error'>"+e.message+"</div>";
});

}

}

</script>

</body>
</html>
